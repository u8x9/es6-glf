<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Promise 的 all/race/catch 方法的应用</title>
</head>
<body>
<script>
    /*
    // --- cache
    function foo() {
        return new Promise((resolve, reject) => {
            setTimeout(() => {
                resolve();
            }, 1000);
        });
    }

    foo().then(() => {
        console.log('甲');
        return foo();
    }).then(() => {
        console.log('乙');
        return foo();
    }).then(() => {
        console.log('丙');
        // 制造一下异常
        console.log(notExistsVar);
        return foo();
    }).then(() => {
        console.log('丁');
        return foo();
    }).catch(reason => { // 捕获回调里的异常
        console.log('出问题了！', reason);
    });
     */

    let one = new Promise((resolve, reject) => {
        setTimeout(() => {
            resolve('aa');
        }, 1000);
    });
    let two = new Promise((resolve, reject) => {
        setTimeout(() => {
            resolve('bb');
        }, 5000);
    });
    let three = new Promise((resolve, reject) => {
        setTimeout(() => {
            resolve('cc');
        }, 300);
    });
    /*
    // --- all
    // 全部执行后一起返回
    Promise.all([one, two, three]).then(arr => {
        let [a, b, c] = arr;
        console.log(a);
        console.log(b);
        console.log(c);
    });
    */
    // -- race
    // 返回执行最快的
    Promise.race([one, two, three]).then(arr => {
        console.log(arr);
    });
</script>
</body>
</html>